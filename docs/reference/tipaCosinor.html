<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Calculate the phase shift induced by a stimulus during a circadian
time-course. — tipaCosinor • tipa</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Calculate the phase shift induced by a stimulus during a circadian
time-course. — tipaCosinor" />
<meta property="og:description" content="tipaCosinor calculates the phase shift based on fitting sine curves to
waveform data before and after the stimulus, accounting for possible period
changes and for the point in the circadian cycle at which the stimulus
occurred. This function will work best for measurements whose rhythms are
approximately sinusoidal, or at least smoothly increasing and decreasing. If
your data are not sinusoidal, you can first define the phase reference points
and then use tipaPhaseRef." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tipa</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/tipa.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/hugheylab/tipa/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate the phase shift induced by a stimulus during a circadian
time-course.</h1>
    <small class="dont-index">Source: <a href='https://github.com/hugheylab/tipa/blob/master/R/tipa.R'><code>R/tipa.R</code></a></small>
    <div class="hidden name"><code>tipaCosinor.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>tipaCosinor</code> calculates the phase shift based on fitting sine curves to
waveform data before and after the stimulus, accounting for possible period
changes and for the point in the circadian cycle at which the stimulus
occurred. This function will work best for measurements whose rhythms are
approximately sinusoidal, or at least smoothly increasing and decreasing. If
your data are not sinusoidal, you can first define the phase reference points
and then use <code><a href='tipaPhaseRef.html'>tipaPhaseRef</a></code>.</p>
    </div>

    <pre class="usage"><span class='fu'>tipaCosinor</span>(<span class='no'>time</span>, <span class='no'>y</span>, <span class='no'>stimOnset</span>, <span class='kw'>stimDuration</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>periodGuess</span> <span class='kw'>=</span> <span class='fl'>24</span>,
  <span class='kw'>trend</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>shortcut</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>time</th>
      <td><p>Vector of time values for the full time-course.</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>Vector of measurements (e.g., bioluminescence) for the full
time-course.</p></td>
    </tr>
    <tr>
      <th>stimOnset</th>
      <td><p>Time at which the stimulus started.</p></td>
    </tr>
    <tr>
      <th>stimDuration</th>
      <td><p>Duration of the stimulus and any transients. Data between
<code>stimOnset</code> and <code>stimOnset + stimDuration</code> will be ignored.</p></td>
    </tr>
    <tr>
      <th>periodGuess</th>
      <td><p>Approximate period of the oscillations (in the same units
used in <code>time</code>), used as initial value in fitting the sine curves.</p></td>
    </tr>
    <tr>
      <th>trend</th>
      <td><p>Model a long-term trend in the cosinor fit for each epoch. Uses
a natural cubic spline with 4 degrees of freedom. It is strongly recommended
to keep as <code>TRUE</code>. If set to <code>FALSE</code>, the function may give an error or give
completely invalid results.</p></td>
    </tr>
    <tr>
      <th>shortcut</th>
      <td><p>Calculate phase shift using the standard TIPA procedure or
using a shortcut based on the phases of the sine curve fits. The two methods
give exactly the same result.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list.</p>
<dt>phaseShift</dt><dd><p>Estimated phase shift in circadian hours. Negative values
correspond to a delay, positive values an advance.</p></dd>
<dt>epochInfo</dt><dd><p>Dataframe containing information about the sine curve fits
for each epoch: period (in the same units used in <code>time</code>), phase (in radians),
and root mean square error (in the same units as <code>y</code>). If the RMS errors
pre-stimulus and post-stimulus are substantially different, then the stimulus
may have induced a change in the waveform and thus phase shift estimates may
be invalid.</p></dd>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='tipaPhaseRef.html'>tipaPhaseRef</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Time-course data from multiple (simulated) experiments</span>
<span class='no'>timecourseFile</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span>(<span class='st'>'extdata'</span>, <span class='st'>'timecourses.csv'</span>, <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>'tipa'</span>)
<span class='no'>df</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span>(<span class='no'>timecourseFile</span>, <span class='kw'>stringsAsFactors</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)

<span class='no'>resultList</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/sort.html'>sort</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span>(<span class='no'>df</span>$<span class='no'>expId</span>)), <span class='kw'>function</span>(<span class='no'>ii</span>) {
        <span class='no'>time</span> <span class='kw'>=</span> <span class='no'>df</span>$<span class='no'>time</span>[<span class='no'>df</span>$<span class='no'>expId</span> <span class='kw'>==</span> <span class='no'>ii</span>]
        <span class='no'>y</span> <span class='kw'>=</span> <span class='no'>df</span>$<span class='no'>intensity</span>[<span class='no'>df</span>$<span class='no'>expId</span> <span class='kw'>==</span> <span class='no'>ii</span>]
   <span class='fu'>tipaCosinor</span>(<span class='no'>time</span>, <span class='no'>y</span>, <span class='kw'>stimOnset</span> <span class='kw'>=</span> <span class='fl'>0</span>)
})

<span class='no'>phaseShifts</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span>(<span class='no'>resultList</span>, <span class='kw'>function</span>(<span class='no'>r</span>) <span class='no'>r</span>$<span class='no'>phaseShift</span>)

<span class='fu'><a href='https://rdrr.io/r/utils/write.table.html'>write.csv</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(<span class='kw'>expId</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sort.html'>sort</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span>(<span class='no'>df</span>$<span class='no'>expId</span>)), <span class='kw'>phaseShift</span> <span class='kw'>=</span> <span class='no'>phaseShifts</span>),
          <span class='st'>'tipa_cosinor.csv'</span>, <span class='kw'>quote</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>row.names</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Jake Hughey.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


