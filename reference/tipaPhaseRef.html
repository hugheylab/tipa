<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Calculate the phase shift based on the times of a phase reference point
(e.g., onset of activity), accounting for possible period changes and for the
point in the circadian cycle at which the stimulus occurred. If the rhythms
of the measurement are approximately sinusoidal, it is recommended to instead
use tipaCosinor()."><title>Use phase reference points to estimate the phase shift induced by a stimulus
during a circadian time-course. — tipaPhaseRef • tipa</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Use phase reference points to estimate the phase shift induced by a stimulus
during a circadian time-course. — tipaPhaseRef"><meta property="og:description" content="Calculate the phase shift based on the times of a phase reference point
(e.g., onset of activity), accounting for possible period changes and for the
point in the circadian cycle at which the stimulus occurred. If the rhythms
of the measurement are approximately sinusoidal, it is recommended to instead
use tipaCosinor()."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">tipa</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.6</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/hugheylab/tipa/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Use phase reference points to estimate the phase shift induced by a stimulus
during a circadian time-course.</h1>
      <small class="dont-index">Source: <a href="https://github.com/hugheylab/tipa/blob/HEAD/R/tipa.R" class="external-link"><code>R/tipa.R</code></a></small>
      <div class="d-none name"><code>tipaPhaseRef.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculate the phase shift based on the times of a phase reference point
(e.g., onset of activity), accounting for possible period changes and for the
point in the circadian cycle at which the stimulus occurred. If the rhythms
of the measurement are approximately sinusoidal, it is recommended to instead
use <code><a href="tipaCosinor.html">tipaCosinor()</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">tipaPhaseRef</span><span class="op">(</span><span class="va">phaseRefTimes</span>, <span class="va">stimOnset</span>, stimDuration <span class="op">=</span> <span class="fl">0</span>, period <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>phaseRefTimes</dt>
<dd><p>Vector of times of the chosen phase reference point.</p></dd>
<dt>stimOnset</dt>
<dd><p>Time at which the stimulus started.</p></dd>
<dt>stimDuration</dt>
<dd><p>Duration of the stimulus and any transients. Data between
<code>stimOnset</code> and <code>stimOnset + stimDuration</code> will be ignored.</p></dd>
<dt>period</dt>
<dd><p>Optional list with elements "pre" and "post" corresponding to
the period of the oscillations prior to and subsequent to the stimulus. If
not supplied, the periods for pre- and post-stimulus are calculated as the
mean time between occurrences of the phase reference point within the
respective epoch. Using this argument is not recommended.</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list.</p>
<dl><dt>phaseShift</dt>
<dd><p>Estimated phase shift in circadian hours. Negative values
indicate a delay, positive values an advance.</p></dd>
<dt>epochInfo</dt>
<dd><p><code>data.frame</code> containing estimated period for each epoch.</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="tipaCosinor.html">tipaCosinor()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co"># Peak times of bioluminescence (in hours)</span></span>
<span class="r-in"><span class="va">phaseRefTimes</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">75.5</span>, <span class="op">-</span><span class="fl">51.5</span>, <span class="op">-</span><span class="fl">27.4</span>, <span class="op">-</span><span class="fl">3.8</span>,</span>
<span class="r-in">                  <span class="fl">20.5</span>, <span class="fl">42.4</span>, <span class="fl">65.5</span>, <span class="fl">88.0</span><span class="op">)</span></span>
<span class="r-in"><span class="va">result</span> <span class="op">=</span> <span class="fu">tipaPhaseRef</span><span class="op">(</span><span class="va">phaseRefTimes</span>, stimOnset <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Data from multiple (simulated) experiments</span></span>
<span class="r-in"><span class="va">getExtrFile</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata'</span>, <span class="st">'phaseRefTimes.csv'</span>, package <span class="op">=</span> <span class="st">'tipa'</span><span class="op">)</span><span class="op">}</span></span>
<span class="r-in"><span class="va">getStimFile</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata'</span>, <span class="st">'stimOnsets.csv'</span>, package <span class="op">=</span> <span class="st">'tipa'</span><span class="op">)</span><span class="op">}</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">extrDf</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu">getExtrFile</span><span class="op">(</span><span class="op">)</span>, stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-in"><span class="va">stimDf</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu">getStimFile</span><span class="op">(</span><span class="op">)</span>, stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">resultList</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">stimDf</span><span class="op">$</span><span class="va">expId</span>, <span class="kw">function</span><span class="op">(</span><span class="va">ii</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in">  <span class="va">phaseRefTimes</span> <span class="op">=</span> <span class="va">extrDf</span><span class="op">$</span><span class="va">phaseRefTime</span><span class="op">[</span><span class="va">extrDf</span><span class="op">$</span><span class="va">expId</span> <span class="op">==</span> <span class="va">ii</span><span class="op">]</span></span>
<span class="r-in">  <span class="va">stimOnset</span> <span class="op">=</span> <span class="va">stimDf</span><span class="op">$</span><span class="va">stimOnset</span><span class="op">[</span><span class="va">stimDf</span><span class="op">$</span><span class="va">expId</span> <span class="op">==</span> <span class="va">ii</span><span class="op">]</span></span>
<span class="r-in">  <span class="fu">tipaPhaseRef</span><span class="op">(</span><span class="va">phaseRefTimes</span>, <span class="va">stimOnset</span><span class="op">)</span><span class="op">}</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">phaseShifts</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">resultList</span>, <span class="kw">function</span><span class="op">(</span><span class="va">r</span><span class="op">)</span> <span class="va">r</span><span class="op">$</span><span class="va">phaseShift</span><span class="op">)</span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Jake Hughey.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

    </footer></div>

  

  

  </body></html>

