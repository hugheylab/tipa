<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Use cosinor regression to estimate the phase shift induced by a stimulus
during a circadian time-course. — tipaCosinor • tipa</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Use cosinor regression to estimate the phase shift induced by a stimulus
during a circadian time-course. — tipaCosinor"><meta property="og:description" content="Calculate the phase shift based on fitting sine curves to waveform data
before and after the stimulus, accounting for possible period changes and for
the point in the circadian cycle at which the stimulus occurred. This
function will work best for measurements whose rhythms are approximately
sinusoidal, or at least smoothly increasing and decreasing. If your data are
not sinusoidal, you can first define the phase reference points and then use
tipaPhaseRef()."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tipa</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/hugheylab/tipa/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Use cosinor regression to estimate the phase shift induced by a stimulus
during a circadian time-course.</h1>
    <small class="dont-index">Source: <a href="https://github.com/hugheylab/tipa/blob/HEAD/R/tipa.R" class="external-link"><code>R/tipa.R</code></a></small>
    <div class="hidden name"><code>tipaCosinor.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculate the phase shift based on fitting sine curves to waveform data
before and after the stimulus, accounting for possible period changes and for
the point in the circadian cycle at which the stimulus occurred. This
function will work best for measurements whose rhythms are approximately
sinusoidal, or at least smoothly increasing and decreasing. If your data are
not sinusoidal, you can first define the phase reference points and then use
<code><a href="tipaPhaseRef.html">tipaPhaseRef()</a></code>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">tipaCosinor</span><span class="op">(</span>
  <span class="va">time</span>,
  <span class="va">y</span>,
  <span class="va">stimOnset</span>,
  stimDuration <span class="op">=</span> <span class="fl">0</span>,
  periodGuess <span class="op">=</span> <span class="fl">24</span>,
  trend <span class="op">=</span> <span class="cn">TRUE</span>,
  shortcut <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>time</dt>
<dd><p>Vector of time values for the full time-course.</p></dd>
<dt>y</dt>
<dd><p>Vector of measurements (e.g., bioluminescence) for the full
time-course.</p></dd>
<dt>stimOnset</dt>
<dd><p>Time at which the stimulus started.</p></dd>
<dt>stimDuration</dt>
<dd><p>Duration of the stimulus and any transients. Data between
<code>stimOnset</code> and <code>stimOnset + stimDuration</code> will be ignored.</p></dd>
<dt>periodGuess</dt>
<dd><p>Approximate period of the oscillations (in the same units
used in <code>time</code>), used as initial value in fitting the sine curves.</p></dd>
<dt>trend</dt>
<dd><p>Model a long-term trend in the cosinor fit for each epoch. Uses
a natural cubic spline with 4 degrees of freedom. It is strongly
recommended to keep as <code>TRUE</code>. If set to <code>FALSE</code>, the function may give an
error or give completely invalid results.</p></dd>
<dt>shortcut</dt>
<dd><p>Calculate phase shift using the standard TIPA procedure or
using a shortcut based on the phases of the sine curve fits. The two
methods give exactly the same result.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A list.</p>
<dl><dt>phaseShift</dt>
<dd><p>Estimated phase shift in circadian hours. Negative values
correspond to a delay, positive values an advance.</p></dd>
<dt>epochInfo</dt>
<dd><p>Dataframe containing information about the sine curve fits
for each epoch: period (in the same units used in <code>time</code>), phase (in
radians), and root mean square error (in the same units as <code>y</code>). If the RMS
errors pre-stimulus and post-stimulus are substantially different, then the
stimulus may have induced a change in the waveform and thus phase shift
estimates may be invalid.</p></dd>
</dl></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="tipaPhaseRef.html">tipaPhaseRef()</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co"># Time-course data from multiple (simulated) experiments</span></span>
<span class="r-in"><span class="va">getTimecourseFile</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata'</span>, <span class="st">'timecourses.csv'</span>, package <span class="op">=</span> <span class="st">'tipa'</span><span class="op">)</span><span class="op">}</span></span>
<span class="r-in"><span class="va">df</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu">getTimecourseFile</span><span class="op">(</span><span class="op">)</span>, stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">resultList</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">expId</span><span class="op">)</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">ii</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in">  <span class="va">time</span> <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">time</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">expId</span> <span class="op">==</span> <span class="va">ii</span><span class="op">]</span></span>
<span class="r-in">  <span class="va">y</span> <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">intensity</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">expId</span> <span class="op">==</span> <span class="va">ii</span><span class="op">]</span></span>
<span class="r-in">  <span class="fu">tipaCosinor</span><span class="op">(</span><span class="va">time</span>, <span class="va">y</span>, stimOnset <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">}</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">phaseShifts</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">resultList</span>, <span class="kw">function</span><span class="op">(</span><span class="va">r</span><span class="op">)</span> <span class="va">r</span><span class="op">$</span><span class="va">phaseShift</span><span class="op">)</span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Jake Hughey.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

